CMAKE_MINIMUM_REQUIRED (VERSION 2.8)

LINK_DIRECTORIES (
   ${PYTHON_LIBRARY_DIRS} ${GTKMM_LIBRARY_DIRS} ${SQLITE3_LIBRARY_DIRS} ${CAIRO_LIBRARY_DIRS} ${Boost_LIBARY_DIRS})

INCLUDE_DIRECTORIES (
	${PYTHON_INCLUDE_PATH} ${GTKMM_INCLUDE_DIRS}  ${SQLITE3_INCLUDE_DIRS} ${CAIRO_INCLUDE_DIRS} ${Boost_INCLUDE_DIRS})

ADD_DEFINITIONS (-Wall -W)
SET (CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -O3 -funroll-loops")

SET (SRC spikedb.cpp gui.cpp uiMenuBar.cpp uiAnalysis.cpp uiFileDetailsTreeView.cpp uiFilterFrame.cpp uiTags.cpp spikedata.cpp settings.cpp easyplotmm/easyplotmm.cpp tokenize.cpp pySpikeDB.cpp)

ADD_EXECUTABLE (spikedb ${SRC})

TARGET_LINK_LIBRARIES (spikedb ${PYTHON_LIBRARIES} ${Boost_LIBRARIES} ${GTKMM_LIBRARIES} ${SQLITE3_LIBRARIES} ${CAIRO_LIBRARIES})

IF(APPLE)
get_filename_component(BUNDLE_ICON_NAME ${CPACK_BUNDLE_ICON} NAME_WE)
set_target_properties(spikedb PROPERTIES MACOSX_BUNDLE TRUE)
set_target_properties(spikedb PROPERTIES MACOSX_BUNDLE_GUI_IDENTIFIER ${CPACK_BUNDLE_IDENTIFIER})
set_target_properties(spikedb PROPERTIES MACOSX_BUNDLE_ICON_FILE ${BUNDLE_ICON_NAME})
set_target_properties(spikedb PROPERTIES MACOSX_BUNDLE_BUNDLE_NAME ${CPACK_BUNDLE_NAME})
set_target_properties(spikedb PROPERTIES MACOSX_BUNDLE_BUNDLE_VERSION ${VERSION})
set_target_properties(spikedb PROPERTIES MACOSX_BUNDLE_LONG_VERSION_STRING ${VERSION})
set_target_properties(spikedb PROPERTIES MACOSX_BUNDLE_SHORT_VERSION_STRING ${VERSION})
add_custom_command(TARGET spikedb POST_BUILD
    COMMAND mkdir -p ${BUNDLE_LOCATION}/Contents/Resources/
    COMMAND cp ${CPACK_BUNDLE_ICON} ${BUNDLE_LOCATION}/Contents/Resources/
	COMMAND cp -r ${CMAKE_SOURCE_DIR}/src/plugins ${BUNDLE_LOCATION}/Contents/Resources/
    DEPENDS wiLink)
ENDIF(APPLE)
